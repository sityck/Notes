# 常见的WEB漏洞

本章节挑选介绍较为详细的WEB漏洞介绍博客，若互联网无较为通俗易懂或者体系化介绍的，将自行编写介绍。

对于WEB漏洞，漏洞的原理都较为简单，关键在于寻找漏洞点以及了解数据传递流程。

## 一、SQL注入

https://zhuanlan.zhihu.com/p/320579411

> SQL注入通常来讲常见的有三类：各种直接或间接注入、报错注入、盲注。
>
> 1、直接或间接注入就是你的注入语句能够被解析并在前端页面获得反馈，该类可以细分为数据型注入、字符型注入、联合型注入等等，但是大体的思路是一致的。
>
> 2、报错注入的关键在于业务系统会将你的SQL执行报错抛回前端页面，那么我们就能够在报错语句中做手脚，利用数据库的特性使得报错语句中回显我们执行内容的结果。通常会利用updatexml以及evtractvalue函数来注入。
>
> 3、盲注即无直接回显的注入，通常通过布尔盲注和时间盲注的方式来利用，由于手工测试效率较差，盲注通常建议利用自动化工具或脚本进行探测执行。

### SQL注入Tips

对于SQL注入，当前JAVA工程的防御手段都是通过预编译的办法进行防御，并且基本实现了基于预编译编码要求的代码安全扫描能力，能够实现SQL注入的自动化代码扫描。但是有一类属性值（order by、SQL关键字、表名库名等等）是无法被参数化的，无法直接依赖预编译进行防御。

[SQL预编译中order by后为什么不能参数化](https://www.cnblogs.com/lsdb/p/12084038.html)

## 二、XSS注入

https://www.jianshu.com/p/4fcb4b411a66

> XSS注入通常来说分为存储型和反射型注入，通常来讲存储型的注入危害较大，基本对于会有数据在页面显示的接口都需要测试XSS注入。该类测试的关键点在于各种绕过手段，所以了解后台防御机制以及掌握较多的payload或者注入手段最为关键。

### XSS注入TIPS

1、[XSSpayload](https://www.jianshu.com/p/0cb3d4354c85)

2、如何绕过Httponly？

- [XST攻击](https://zhuanlan.zhihu.com/p/61990354)
- 通过`<iframe>`标签嵌入一个远程域，完全撑开后，以覆盖原有的页面。
- 通过js伪造登录表单，欺骗浏览器自动填入，由此获取浏览器记住的历史密码。
- 跳转至自己的钓鱼页面

## 三、XXE注入

https://blog.csdn.net/weixin_44420143/article/details/118721145

> XXE注入实际上是XML解析机制导致缺陷，通过解析外部实体或者构造特殊的XML文件来实现文件读取、命令执行、内网扫描、拒绝服务等目的。通常来讲现在的代码工程都不在使用XML作为数据传输载体，而若使用了XML的载体，则会禁用外部实体解析及DTD。并且现如今的代码安全扫描已基本能够覆盖XXE注入漏洞的扫描发现。
>
> 值得注意的是，除了网上列出的几种外部实体解析的利用渠道，XXE还可以注入XML炸弹实现拒绝服务攻击，该类的防护手段即禁用DTD能力。具体可参考微软文档：https://learn.microsoft.com/zh-cn/archive/msdn-magazine/2009/november/xml-denial-of-service-attacks-and-defenses。

## 四、CSRF攻击

https://zhuanlan.zhihu.com/p/398601816

> 对于CSRF攻击，按照代码规范正确设计会话框架的系统基本不会再存在此类漏洞。一般重点关注那些只有cookie没有token辅助鉴权的系统。
>
> CSRF攻击的核心要点是伪造攻击，所以利用手段通常是诱导用户去点击我们产生的恶意链接，这个通常和钓鱼的手法类似，或者说可以结合起来进行。

## 五、SSRF攻击

https://cloud.tencent.com/developer/article/2103240

> SSRF攻击本质上来讲就是让服务器替你执行协议请求，包括HTTP、File、gopher、dict等协议。因为服务器处于内网且可能与其他节点存在互信机制，所以可以通过此办法绕过防火墙等机制，常见的情况用于文件读取以及端口/漏洞扫描。

[SSRF利用手段](https://www.cnblogs.com/-chenxs/p/11749367.html)

## 六、文件上传漏洞

https://www.freebuf.com/vuls/279171.html

> 文件上传漏洞是每个应用系统必测的漏洞，且经常出现漏洞。老旧系统容易通过文件上传实现木马上传，尤其是PHP、JSP等编程语言编写的WEB网站。同时，文件上传还可以实现DDOS攻击、跨路径覆盖等破坏性操作。通常认为文件上传应针对每个细致点进行测试：文件类型校验、文件大小校验、文件名校验、文件存储路径校验、文件名随机化检查、文件目录占满检查等。

### 文件上传TIPS

- 绕过及解析漏洞：https://www.freebuf.com/articles/web/265245.html
- 跨路径覆盖漏洞：跨路径覆盖原理很简单，当文件存储的目录用户可控时，用户可以通过拼接"../"的方式来实现上传文件的存储路径自定义，那么是否可以实现一些关键系统文件的篡改？或者将文件存储到WEB目录？可参考帆软的一个真实漏洞：https://xz.aliyun.com/t/9578
- 压缩包跨路径覆盖：可直接参考ZIP Slip漏洞，这个漏洞的原理和跨路径覆盖差不多。https://www.freebuf.com/vuls/180383.html

## 七、文件下载漏洞

https://cloud.tencent.com/developer/article/1680590

> 文件下载类型的漏洞通常指任意文件下载，由于开发没有对文件下载/读取的路径做校验，我们可以通过../或者其编码来绕过管控实现/etc/passwd等敏感文件的下载读取。

## 八、命令注入漏洞

https://blog.csdn.net/LYJ20010728/article/details/117349106

> 命令注入在PHP系统中较为常见，一般的JAVA项目较少出现此类漏洞；这主要是由业务需求决定的。命令注入实际上也是利用开发在进行代码编写时，未考虑到某些参数是用户可控的，没有进行针对性防护导致漏洞的存在，比如一个探测网络状态的ping命令，开发使用exec()函数在后台直接执行ping命令，将用户输入拼接到ping命令后面，并将命令执行的结果返回，当这一过程没有防护时，恶意用户可以通过127.0.0.1;whoami等形式来实现命令注入攻击。
>
> 对于命令注入漏洞，最好的测试方式应该是白盒测试，通过代码关键字检索来追踪命令执行的参数来源，确认是否有防护以及防护是否妥当。目前代码安全扫描已经能覆盖部分命令注入漏洞是识别。
>
> 对于此类问题的防护，最合适的方式是白名单或正则字符白名单限制机制。

## 九、REDOS漏洞

该博客侧重原理说明：

https://www.cnblogs.com/wwlww/p/8413313.html

该博客侧重实际应用（包含测试手段）：

https://blog.csdn.net/jiangdefu/article/details/123438498

> REDOS漏洞算是一类冷门的WEB漏洞，但是在目前校验机制大量依赖正则表达式的情况下，此类漏洞不得不关注。REDOS漏洞实际上就是因为当我们的正则API基于NFA引擎时，由于NFA的贪婪特性，一个正则表达式在遇到特殊构造的语句时，语句每多一位，可能会导致迭代次数呈指数级上升，最终耗尽CPU资源，实现拒绝服务攻击。
>
> REDOS漏洞常出现两种场景：1、系统允许用户自行定义正则表达式，未做校验导致用户可通过自定义正则来实现系统资源耗尽；2、系统预置的正则表达式存在缺陷，用户可通过构造特定字符串来实现系统资源耗尽。
>
> 此类漏洞的测试方法通过通过自动化扫描实现，通过自动调用正则表达式测试工具来识别出存在缺陷的正则表达式；对于场景1则依赖人工识别。
>
> NFA引擎原理详解：
>
> https://blog.csdn.net/liaowenxiong/article/details/118398976

## 十、URL跳转漏洞

https://cloud.tencent.com/developer/article/1601709

> URL跳转漏洞在如今架构的系统中也是较为少见了，主要需要关注URL跳转的功能点是否存在用户可以自行输入URL的场景或者URL可从其他地方注入。
>
> 另类的URL跳转漏洞：<a>标签导致的钓鱼风险（实际上是浏览器的问题）：https://www.jianshu.com/p/2762f6355e1d
